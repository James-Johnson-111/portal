(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[29],{670:function(e,t,n){},671:function(e,t,n){},672:function(e,t,n){},773:function(e,t,n){"use strict";n.r(t);var a=n(11),c=n(8),s=n(1),i=n(76),o=n(79),r=n(10),d=(n(670),n(25)),l=n(94),u=n(3),j=(n(671),n(0)),p=function(e){var t=Object(s.useState)([]),n=Object(c.a)(t,2),a=n[0],i=n[1],o=Object(s.useState)([]),r=Object(c.a)(o,2),d=r[0],l=r[1];return Object(s.useEffect)((function(){i(e.Companies),l(e.Locations)}),[e.Locations,e.Companies]),Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"SearchContainer",children:[Object(j.jsxs)("div",{className:"SearchBar",children:[Object(j.jsx)("div",{children:Object(j.jsx)("i",{class:"las la-search"})}),Object(j.jsx)("input",{type:"text",placeholder:"Tap To Search",className:"form-control",onChange:function(t){return e.onSearchPO("Key",t)}})]}),Object(j.jsxs)("div",{className:"SearchFiltersContainer",children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{children:"Companies"}),Object(j.jsxs)("select",{name:"companies",id:"",onChange:e.onChangeCompany,className:"form-control",children:[Object(j.jsx)("option",{value:"",children:"Default"}),a.map((function(e){return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("option",{value:e.company_code,children:e.company_name})})}))]})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{children:"Locations"}),Object(j.jsxs)("select",{onChange:e.onChangeLocation,className:"form-control",children:[Object(j.jsx)("option",{value:"",children:"Default"}),d.map((function(e){return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("option",{value:e.location_code,children:e.location_name})})}))]})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{children:"Status"}),Object(j.jsxs)("select",{onChange:function(t){return e.onSearchPO("Status",t)},className:"form-control",children:[Object(j.jsx)("option",{value:"",children:"Default"}),Object(j.jsx)("option",{value:"Approved",children:"Approved"}),Object(j.jsx)("option",{value:"Rejected",children:"Rejected"}),Object(j.jsx)("option",{value:"Waiting For Approval",children:"Waiting For Approval"}),Object(j.jsx)("option",{value:"Sent",children:"Sent"}),Object(j.jsx)("option",{value:"Viewed",children:"Viewed"})]})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{children:"Date"}),Object(j.jsx)("input",{type:"date",onChange:function(t){return e.onSearchPO("MyDate",t)},className:"form-control",name:""})]})]})]})})},b=(n(672),n(17)),h=function(e){var t="#0eb8de",n=e.data.status;return"Approved"!==e.data.status&&"Delivered"!==e.data.status||(t="#307365",n="Approved By accounts"),"Rejected"===e.data.status&&(t="#d19399",n="Rejected by accounts"),"Waiting For Approval"===e.data.status&&(t="#fc9701",n="Received"),"Sent"===e.data.status&&(n="Received"),"Viewed"===e.data.status&&(n="Viewed"),Object(j.jsxs)("div",{className:"ViewPoRequests_div",children:[Object(j.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[Object(j.jsxs)("div",{className:"d-flex align-items-center w-75",children:[Object(j.jsx)("img",{src:"images/employees/"+e.data.emp_image,alt:""}),Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{className:"font-weight-bolder",children:[" ",e.data.name," "]}),Object(j.jsxs)("p",{children:[" ",e.data.designation_name+" in "+e.data.department_name+" Department, "+e.data.company_name," "]})]})]}),Object(j.jsxs)("div",{className:"w-25",children:[Object(j.jsx)("p",{className:"font-weight-bolder",children:"Total"}),Object(j.jsxs)("p",{children:[" Rs ",e.data.total.toLocaleString("en-US")]})]})]}),Object(j.jsx)("div",{className:"py-3",children:Object(j.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{className:"font-weight-bolder",children:"Date"}),Object(j.jsx)("p",{children:e.date.toDateString()})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{className:"font-weight-bolder",children:"Status"}),Object(j.jsx)("p",{style:{backgroundColor:t,fontSize:"10px"},className:"text-white text-center rounded-pill px-2",children:n})]})]})}),Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[Object(j.jsx)("i",{class:"las la-map-marker-alt"}),Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{className:"font-weight-bolder",children:e.data.company_name}),Object(j.jsx)("p",{children:e.data.location_name})]})]}),Object(j.jsx)("div",{className:"ViewPoRequests_button",onClick:function(){return e.ViewRequestDetails(e.data.po_id)},children:Object(j.jsx)(b.b,{className:"btn",to:"/purchaseorder/window=purchaseorder&&id="+e.data.po_id,children:"View"})})]},e.key)},O=Object(s.lazy)((function(){return Promise.all([n.e(3),n.e(5),n.e(47)]).then(n.bind(null,799))})),m=Object(s.lazy)((function(){return n.e(32).then(n.bind(null,814))})),f=Object(s.lazy)((function(){return n.e(69).then(n.bind(null,806))})),v=Object(s.lazy)((function(){return n.e(70).then(n.bind(null,800))})),x=Object(s.lazy)((function(){return n.e(68).then(n.bind(null,801))})),g=Object(s.lazy)((function(){return n.e(71).then(n.bind(null,802))}));t.default=function(){var e=Object(s.useState)(!1),t=Object(c.a)(e,2),n=t[0],b=t[1],w=Object(s.useState)(Object(j.jsx)(j.Fragment,{})),S=Object(c.a)(w,2),y=S[0],N=S[1],_=Object(s.useState)([]),D=Object(c.a)(_,2),C=D[0],k=(D[1],Object(s.useState)({column:"employees.name",value:""})),R=Object(c.a)(k,2),q=R[0],P=R[1],I=Object(s.useState)({column:"companies.company_code",value:""}),A=Object(c.a)(I,2),V=A[0],F=A[1],L=Object(s.useState)({column:"locations.location_code",value:""}),B=Object(c.a)(L,2),E=B[0],J=B[1],z=Object(s.useState)({column:"invtry_purchase_order.status",value:""}),T=Object(c.a)(z,2),H=T[0],W=T[1],Q=Object(s.useState)({column:"invtry_purchase_order.request_date",value:""}),K=Object(c.a)(Q,2),M=K[0],U=K[1],Y=Object(s.useState)([]),G=Object(c.a)(Y,2),X=G[0],Z=G[1],$=Object(s.useState)([]),ee=Object(c.a)($,2),te=ee[0],ne=ee[1],ae=Object(s.useState)([]),ce=Object(c.a)(ae,2),se=ce[0],ie=ce[1],oe=Object(s.useState)([]),re=Object(c.a)(oe,2),de=re[0],le=re[1],ue=Object(s.useState)([]),je=Object(c.a)(ue,2),pe=je[0],be=je[1],he=Object(s.useState)({info:[],specifications:[],venders:[]}),Oe=Object(c.a)(he,2),me=Oe[0],fe=Oe[1],ve=Object(s.useState)({info:[],specifications:[]}),xe=Object(c.a)(ve,2),ge=xe[0],we=xe[1],Se=Object(s.useState)(0),ye=Object(c.a)(Se,2),Ne=ye[0],_e=ye[1],De=Object(s.useState)([]),Ce=Object(c.a)(De,2),ke=Ce[0],Re=Ce[1],qe=Object(s.useState)([]),Pe=Object(c.a)(qe,2),Ie=Pe[0],Ae=Pe[1],Ve=Object(s.useState)([]),Fe=Object(c.a)(Ve,2),Le=Fe[0],Be=Fe[1],Ee=Object(s.useState)([]),Je=Object(c.a)(Ee,2),ze=Je[0],Te=Je[1],He=Object(s.useState)([]),We=Object(c.a)(He,2),Qe=We[0],Ke=We[1],Me=Object(s.useState)([]),Ue=Object(c.a)(Me,2),Ye=Ue[0],Ge=Ue[1],Xe=Object(d.c)((function(e){return e.EmpAuth.EmployeeData})),Ze=Object(u.g)();Object(s.useEffect)((function(){l.a.on("newpurchaseorder",(function(){$e()})),$e(),ct(),at()}),[]),Object(s.useEffect)((function(){var e=window.location.href.split("/").pop().split("id=").pop();r.a.post("/getpridfrompo",{po_id:e}).then((function(t){r.a.post("/getpurchaseorderdetails",{pr_id:t.data[0]?t.data[0].pr_id:null,po_id:e}).then((function(t){Ae([]),Te([]),Ge([]);var n=t.data[0];t.data[4][0]&&(n[0].pr_code=t.data[4][0].pr_code),be(t.data[0]),fe(Object(a.a)(Object(a.a)({},me),{},{info:n,specifications:t.data[1],venders:t.data[3]})),Be(t.data[2]),Ke(t.data[7]),t.data[4][0]?(we(Object(a.a)(Object(a.a)({},ge),{},{info:t.data[4],specifications:t.data[5]})),Re(t.data[6])):(we(Object(a.a)(Object(a.a)({},ge),{},{info:[],specifications:[]})),Re([])),_e(parseInt(e))})).catch((function(e){console.log(e)}))}))}),[window.location.href.split("/").pop().split("id=").pop()]),Object(s.useEffect)((function(){et()}),[q,V,E,H,M]);var $e=function(){var e={emp_id:Xe.emp_id,access:Xe.access};r.a.post("/getallpo",{myData:JSON.stringify(e)}).then((function(e){ie(e.data)})).catch((function(e){console.log(e)}))},et=function(){var e={emp_id:Xe.emp_id,access:Xe.access},t=[q,V,E,H,M];r.a.post("/getallposorted",{myData:JSON.stringify(e),filters:t}).then((function(e){ie(e.data);for(var t=[],n=0;n<e.data.length;n++)t.push(e.data[n].status);le(t)})).catch((function(e){console.log(e)}))},tt=function(){b(!n)},nt=function(e,t){var n=t.target.value;"Key"===e?P(Object(a.a)(Object(a.a)({},q),{},{value:n})):"Company"===e?F(Object(a.a)(Object(a.a)({},V),{},{value:n})):"Location"===e?J(Object(a.a)(Object(a.a)({},E),{},{value:n})):"Status"===e?W(Object(a.a)(Object(a.a)({},H),{},{value:n})):U(Object(a.a)(Object(a.a)({},M),{},{value:n})),"Key"===e&&""===n?P(Object(a.a)(Object(a.a)({},q),{},{value:""})):"Company"===e&&""===n?F(Object(a.a)(Object(a.a)({},V),{},{value:""})):"Location"===e&&""===n?J(Object(a.a)(Object(a.a)({},E),{},{value:""})):"Status"===e&&""===n?W(Object(a.a)(Object(a.a)({},H),{},{value:""})):"MyDate"===e&&""===n&&U(Object(a.a)(Object(a.a)({},M),{},{value:""}))},at=function(){r.a.get("/getalllocations").then((function(e){ne(e.data)})).catch((function(e){console.log(e)}))},ct=function(){r.a.get("/getallcompanies").then((function(e){Z(e.data)})).catch((function(e){console.log(e)}))},st=function(e){if(JSON.parse(Xe.access).includes(523)||JSON.parse(Xe.access).includes(524)||JSON.parse(Xe.access).includes(1)){var t=new FormData;t.append("poID",e),t.append("empID",Xe.emp_id),r.a.post("/setpotoviewed",t).then((function(){l.a.emit("newpurchaseorder")})).catch((function(e){console.log(e)}))}},it=function(e){var t=[];t=ke[0].image?ke.filter((function(t,n,a){return a[n].image===a[e].image})):ke.filter((function(t,n,a){return a[n].name===a[e].name})),Ae(t)},ot=function(e){var t=[];t=Le[0].image?Le.filter((function(t,n,a){return a[n].image===a[e].image})):Le.filter((function(t,n,a){return a[n].name===a[e].name})),Te(t)},rt=function(e){var t=[];t=Qe[0].image?Qe.filter((function(t,n,a){return a[n].image===a[e].image})):Qe.filter((function(t,n,a){return a[n].name===a[e].name})),Ge(t)},dt=function(e){var t=new FileReader,n=e.target.files;t.onload=function(){if(2===t.readyState){for(var e=[],a=0;a<n.length;a++)e.push({name:n[a].name,file:n[a]});Ke(e)}},n[0]&&t.readAsDataURL(n[0])},lt=function(e){var t=Qe.filter((function(t,n,a){return a[n].name!==a[e].name}));Ke(t),Ge([])},ut=function(e,t){t.preventDefault();var n=new FormData;n.append("poID",e),n.append("empID",Xe.emp_id),n.append("remarks",t.target.remarks.value),r.a.post("/setpotodiscard",n).then((function(){var n=new FormData;n.append("eventID",3),n.append("link",""),n.append("receiverID",pe[0].request_by),n.append("senderID",sessionStorage.getItem("EmpID")),n.append("Title",sessionStorage.getItem("name")),n.append("NotificationBody",sessionStorage.getItem("name")+" has discard your purchase order with id#"+pe[0].po_code+" under this reason '"+t.target.remarks.value+"'"),r.a.post("/newnotification",n).then((function(){r.a.post("/sendmail",n).then((function(){l.a.emit("newpurchaseorder"),Ze.replace("/purchaseorder/window=purchaseorder&&id="+(e-1)),setTimeout((function(){Ze.replace("/purchaseorder/window=purchaseorder&&id="+e)}),100),et()}))})),i.b.dark("Request has been Discard",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),b(!1)})).catch((function(e){console.log(e)}))},jt=function(e,t){t.preventDefault();var n=new FormData;n.append("poID",e),n.append("empID",Xe.emp_id),n.append("remarks",t.target.remarks.value),Qe.forEach((function(e){n.append("Attachments",e.file)})),r.a.post("/setpotoapprove",n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){b(!1);var t=new FormData;t.append("eventID",3),t.append("receiverID",pe[0].request_by),t.append("senderID",sessionStorage.getItem("EmpID")),t.append("Title",sessionStorage.getItem("name")),t.append("NotificationBody",sessionStorage.getItem("name")+" has approved your purchase order with id#"+pe[0].po_code),r.a.post("/newnotification",t).then((function(){r.a.post("/sendmail",t).then((function(){l.a.emit("newpurchaseorder"),Ze.replace("/purchaseorder/window=purchaseorder&&id="+(e-1)),setTimeout((function(){Ze.replace("/purchaseorder/window=purchaseorder&&id="+e)}),100),et()}))})),i.b.dark("Request has been approved".toString(),{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){console.log(e)}))};return Object(j.jsxs)("div",{className:"ViewPurchaseOrderContainer",children:[Object(j.jsx)(i.a,{}),Object(j.jsx)(o.a,{show:n,Hide:tt,content:y}),Object(j.jsx)("iframe",{title:"po",id:"po",className:"d-none w-100",src:"https://"+window.location.host+"/#/view=purchase_order/"+Ne}),Object(j.jsx)(p,{Locations:te,Companies:X,onChangeLocation:function(e){nt("Location",e),at()},onChangeCompany:function(e){nt("Company",e),""!==e.target.value?r.a.post("/getcompanylocations",{company_code:e.target.value}).then((function(e){ne(e.data)})).catch((function(e){console.log(e)})):at()},onSearchPO:nt}),Object(j.jsxs)("div",{className:"ViewPurchaseOrderGridContainer",children:[Object(j.jsx)("div",{className:"Left RequestsList",children:se.map((function(e,t){var n=new Date(e.request_date);return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(h,{data:e,date:n,EmpData:Xe,ViewRequestDetails:st},t)})}))}),Object(j.jsxs)("div",{className:"Right RequestDetails",children:[Object(j.jsx)("div",{className:"PreviewWindow",children:Object(j.jsxs)(s.Suspense,{fallback:Object(j.jsx)("div",{children:"Loading...."}),children:[Object(j.jsx)(u.b,{exact:!0,path:"/purchaseorder/home",render:function(){return Object(j.jsx)(O,{ViewRequest:se,CountRequests:se.length,CountStatus:de,MonthlyRequests:C,EmpData:Xe})}}),Object(j.jsx)(u.b,{exact:!0,path:"/purchaseorder/window=purchaseorder&&id=:id",render:function(){return Object(j.jsx)(m,{PurchaseOrderDetails:me})}}),Object(j.jsx)(u.b,{exact:!0,path:"/purchaseorder/window=purchaserequisition&&id=:id",render:function(){return Object(j.jsx)(f,{PurchaseRequisitionDetails:ge})}}),Object(j.jsx)(u.b,{exact:!0,path:"/purchaseorder/window=quotations&&id=:id",render:function(){return Object(j.jsx)(v,{List:pe,AttachQuotations:ke,QuotationPreview:Ie,PreviewQuotation:it})}}),Object(j.jsx)(u.b,{exact:!0,path:"/purchaseorder/window=bills&&id=:id",render:function(){return Object(j.jsx)(x,{AttachBills:Le,BillPreview:ze,PreviewBill:ot})}}),Object(j.jsx)(u.b,{exact:!0,path:"/purchaseorder/window=vouchers&&id=:id",render:function(){return Object(j.jsx)(g,{Details:pe,AttachVouchers:Qe,VoucherPreview:Ye,PreviewVoucher:rt,onAttachVouchers:dt,RemoveVoucher:lt})}})]})}),Object(j.jsx)("div",{className:"POControls",children:"home"!==window.location.href.split("/").pop()?Object(j.jsxs)("div",{className:"btn-group",children:[Object(j.jsx)("button",{className:"btn btn-dark",onClick:function(){return Ze.replace("/purchaseorder/window=purchaseorder&&id="+Ne)},children:"Purchase Order"}),ge.info[0]?Object(j.jsx)("button",{className:"btn btn-primary",onClick:function(){return Ze.replace("/purchaseorder/window=purchaserequisition&&id="+Ne)},children:"Purchase Requisition"}):null,ke.length>0?Object(j.jsx)("button",{className:"btn btn-info",onClick:function(){return Ze.replace("/purchaseorder/window=quotations&&id="+Ne)},children:"Quotations"}):null,Object(j.jsx)("button",{className:"btn btn-light",onClick:function(){return Ze.replace("/purchaseorder/window=bills&&id="+Ne)},children:"Bills"}),Object(j.jsx)("button",{className:"btn btn-danger",onClick:function(){return Ze.replace("/purchaseorder/window=vouchers&&id="+Ne)},children:"Vouchers"}),Object(j.jsx)("button",{className:"btn btn-warning",onClick:function(){return function(e){var t=ge.info[0]?ge.info[0].pr_id:0,n=document.getElementById("po");n.src="https://"+window.location.host+"/#/view=purchase_order/"+t+"/"+e,n.contentWindow.print()}(Ne)},children:"Print"}),pe[0]&&("Viewed"===pe[0].status||"Sent"===pe[0].status)&&Xe.access&&(JSON.parse(Xe.access).includes(523)||JSON.parse(Xe.access).includes(524)||JSON.parse(Xe.access).includes(1))?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("button",{className:"btn btn-sm btn-danger",onClick:function(){return e=window.location.href.split("/").pop().split("id=").pop(),N(Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"Do you want to discard this request?"}),Object(j.jsxs)("form",{onSubmit:function(t){return ut(e,t)},children:[Object(j.jsx)("textarea",{style:{fontSize:"13px"},name:"remarks",className:"form-control mb-3",placeholder:"Add Remarks",required:!0,minLength:"10"}),Object(j.jsx)("button",{type:"submit",className:"btn btn-sm btn-danger d-block ml-auto px-3",children:"Yes"})]})]})),void tt();var e},children:"Discard"}),Object(j.jsx)("button",{className:"btn btn-sm btn-success",onClick:function(){return e=window.location.href.split("/").pop().split("id=").pop(),void(0===Qe.length?i.b.dark("Please attach at least one voucher",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):(N(Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"Do you want to approve this request?"}),Object(j.jsxs)("form",{onSubmit:function(t){return jt(e,t)},children:[Object(j.jsx)("textarea",{style:{fontSize:"13px"},name:"remarks",className:"form-control mb-3",placeholder:"Add Remarks",required:!0,minLength:"10"}),Object(j.jsx)("button",{type:"submit",className:"btn btn-sm btn-success d-block ml-auto px-3",children:"Yes"})]})]})),tt()));var e},children:"Approve"})]}):null]}):null})]})]})]})}},79:function(e,t,n){"use strict";n(1),n(80);var a=n(0);t.a=function(e){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"Attandence_Request_Div",style:{display:e.show?"flex":"none"},children:[Object(a.jsx)("div",{className:"dark",onClick:e.Hide}),Object(a.jsx)("div",{style:{animationDelay:"0.1".toString()+"s"},className:e.show?"Attandence_Request_Div_Content Attandence_Request_Div_Content2":"Attandence_Request_Div_Content",children:e.content})]})})}},80:function(e,t,n){}}]);
//# sourceMappingURL=29.1ac2e9f3.chunk.js.map