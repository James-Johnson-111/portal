(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[53],{766:function(e,t,n){},816:function(e,t,n){"use strict";n.r(t);var a=n(23),s=n(11),i=n(94),c=n(4),r=n(1),o=n(0);var l=function(e){return Object(o.jsxs)("tr",{className:"InputFeilds",children:[Object(o.jsx)("td",{}),Object(o.jsxs)("td",{children:[Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.description,placeholder:"Item Name",name:"description",className:"form-control"}),Object(o.jsx)("small",{className:"text-danger errs err_description"})]}),Object(o.jsxs)("td",{children:[Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.reason,placeholder:"Item Reason",name:"reason",className:"form-control"}),Object(o.jsx)("small",{className:"text-danger errs err_reason"})]}),Object(o.jsxs)("td",{children:[Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.price,placeholder:"Item Rate",pattern:"[0-9]+",name:"price",className:"form-control"}),Object(o.jsx)("small",{className:"text-danger errs err_price"})]}),Object(o.jsxs)("td",{children:[Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.quantity,placeholder:"Item Quantity",pattern:"[0-9]+",name:"quantity",className:"form-control"}),Object(o.jsx)("small",{className:"text-danger errs err_quantity"})]}),Object(o.jsxs)("td",{children:[Object(o.jsx)("input",{type:"text",value:"Rs "+e.Amount.toLocaleString("en-US"),placeholder:"Item Amount",pattern:"[0-9]+",name:"itemAmount",className:"form-control",disabled:!0}),Object(o.jsx)("small",{className:"text-danger errs err_itemAmount"})]})]})};n(766);var d=function(e){return Object(o.jsxs)("div",{className:"InvoiceBuilder",children:[Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"title",children:Object(o.jsx)("h2",{children:"PURCHASE REQUISITION"})}),Object(o.jsxs)("div",{className:"upper",children:[Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"input-group",children:[Object(o.jsx)("span",{className:"input-group-text",id:"basic-addon3",children:"Company"}),Object(o.jsx)("input",{disabled:!0,type:"text",className:"form-control",value:e.RequestDetails.info[0].company_name})]}),Object(o.jsxs)("div",{className:"input-group",children:[Object(o.jsx)("span",{className:"input-group-text",id:"basic-addon3",children:"Delivery Location"}),Object(o.jsx)("input",{disabled:!0,type:"text",className:"form-control",value:e.RequestDetails.info[0].location_name})]})]}),Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"input-group",children:[Object(o.jsx)("span",{className:"input-group-text",id:"basic-addon3",children:"Request By"}),Object(o.jsx)("input",{disabled:!0,type:"text",className:"form-control",value:e.RequestDetails.info[0].sender_name,name:""})]}),Object(o.jsxs)("div",{className:"input-group",children:[Object(o.jsx)("span",{className:"input-group-text",id:"basic-addon3",children:"Request For"}),Object(o.jsx)("input",{disabled:!0,type:"text",className:"form-control",value:e.RequestDetails.info[0].emp_for_name===e.RequestDetails.info[0].sender_name?"Self":e.RequestDetails.info[0].emp_for_name,name:""})]})]}),Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"input-group",children:[Object(o.jsx)("span",{className:"input-group-text",id:"basic-addon3",children:"Request To"}),Object(o.jsx)("input",{disabled:!0,type:"text",className:"form-control",value:e.RequestDetails.info[0].handle_emp_name,name:""})]}),Object(o.jsxs)("div",{className:"input-group",children:[Object(o.jsx)("span",{className:"input-group-text",id:"basic-addon3",children:"Attachments"}),Object(o.jsxs)("select",{className:"form-control AttachmentsSelect",onChange:e.AttchemntsMode,children:[Object(o.jsx)("option",{value:"",children:"Select the option"}),Object(o.jsx)("option",{value:"view",children:"View"}),Object(o.jsx)("option",{value:"yes",children:"Yes"}),Object(o.jsx)("option",{value:"no",children:"No"})]})]})]})]})]}),Object(o.jsx)("div",{className:"items_list",children:Object(o.jsxs)("div",{className:"items_list_content",children:[Object(o.jsx)("div",{className:"list",id:"ItemsLIst",children:Object(o.jsxs)("table",{className:"table",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"Sr.No"}),Object(o.jsx)("th",{children:"Item Name"}),Object(o.jsx)("th",{children:"Item Reason"}),Object(o.jsx)("th",{children:"Rate"}),Object(o.jsx)("th",{children:"Quantity"}),Object(o.jsx)("th",{children:"Amount"})]})}),Object(o.jsxs)("tbody",{children:[e.Items.map((function(t,n){return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("tr",{className:"items data itemsData"+n,children:[Object(o.jsxs)("td",{children:[" ",n+1," "]}),Object(o.jsxs)("td",{children:[" ",t.description," "]}),Object(o.jsx)("td",{children:t.reason}),Object(o.jsx)("td",{children:t.price}),Object(o.jsx)("td",{children:t.quantity}),Object(o.jsx)("td",{children:"Rs "+t.amount.toLocaleString("en-US")}),Object(o.jsxs)("div",{className:"abs",children:[Object(o.jsx)("i",{className:"lar la-edit",title:"Edit",onClick:function(){return e.OnEdit(n)}}),Object(o.jsx)("i",{className:"las la-trash",title:"Remove",onClick:function(){return e.onDelete(n)}})]})]},n),Object(o.jsxs)("tr",{className:"items edition itemsEdit itemsEdit"+n,children:[Object(o.jsx)("td",{}),Object(o.jsx)("td",{children:Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.description,placeholder:"Item Name",name:"description",className:"form-control"})}),Object(o.jsx)("td",{children:Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.reason,placeholder:"Item Reason",name:"reason",className:"form-control"})}),Object(o.jsx)("td",{children:Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.price,placeholder:"Item Rate",pattern:"[0-9]+",name:"price",className:"form-control"})}),Object(o.jsx)("td",{children:Object(o.jsx)("input",{onChange:e.onChnageHandler,onKeyDown:e.AddItem,type:"text",value:e.Item.quantity,placeholder:"Item Quantity",pattern:"[0-9]+",name:"quantity",className:"form-control"})}),Object(o.jsx)("td",{children:Object(o.jsx)("input",{type:"text",value:"Rs "+e.Amount.toLocaleString("en-US"),placeholder:"Item Amount",pattern:"[0-9]+",name:"itemAmount",className:"form-control",disabled:!0})})]},n)]})})),e.EditMode?null:Object(o.jsx)(l,{onChnageHandler:e.onChnageHandler,AddItem:e.AddItem,Item:e.Item,Amount:e.Amount})]})]})}),Object(o.jsxs)("div",{className:"controls",children:[Object(o.jsx)("div",{children:Object(o.jsxs)("div",{className:"input-group",children:[Object(o.jsx)("span",{className:"input-group-text",id:"basic-addon3",children:"Total"}),Object(o.jsx)("input",{type:"text",className:"form-control",disabled:!0,name:"",value:"Rs "+e.Total.toLocaleString("en-US")})]})}),Object(o.jsxs)("div",{className:"text-right",children:[e.RequestDetails.info.length>0&&("Viewed"===e.RequestDetails.info[0].status||"Sent"===e.RequestDetails.info[0].status)?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("button",{className:"btn saveBtn",onClick:function(){return e.onSendingForApproval(e.RequestDetails.info[0].pr_id)},children:"Forward"}),Object(o.jsx)("button",{className:"btn",style:{backgroundColor:"red",color:"white"},onClick:function(){return e.onDiscard(e.RequestDetails.info[0].pr_id)},children:"Discard"})]}):null,e.EmpData.access&&JSON.parse(e.EmpData.access).includes(514)&&"Approved"!==e.RequestDetails.info[0].status&&"Delivered"!==e.RequestDetails.info[0].status?Object(o.jsx)("button",{className:"btn",style:{backgroundColor:"orange",color:"white"},onClick:function(){return e.onOverride(e.RequestDetails.info[0].pr_id)},children:"Override"}):null]})]})]})})]})},u=n(75),m=n.n(u),p=n(80),j=n(10),h=n(77);n(78),t.default=function(e){var t=Object(r.useState)({description:"",reason:"",price:0,quantity:1}),n=Object(c.a)(t,2),l=n[0],u=n[1],b=Object(r.useState)([]),f=Object(c.a)(b,2),O=f[0],x=f[1],v=Object(r.useState)([]),g=Object(c.a)(v,2),y=g[0],I=g[1],D=Object(r.useState)(0),N=Object(c.a)(D,2),q=N[0],A=N[1],R=Object(r.useState)(0),S=Object(c.a)(R,2),C=S[0],w=S[1],_=Object(r.useState)(!1),E=Object(c.a)(_,2),k=E[0],B=E[1],F=Object(r.useState)(),T=Object(c.a)(F,2),H=T[0],L=T[1],U=Object(r.useState)(Object(o.jsx)(o.Fragment,{})),K=Object(c.a)(U,2),J=K[0],M=K[1],Q=Object(r.useState)(!1),P=Object(c.a)(Q,2),Y=P[0],V=P[1],z=function(t){if(y.length>0){var n=new FormData;n.append("prID",t),n.append("Items",JSON.stringify(y)),n.append("Total",C),j.a.post("/setprtofinal",n).then((function(){var n=new FormData;n.append("prID",t),n.append("empID",e.EmpData.emp_id),O.forEach((function(e){n.append("Attachments",e.file)})),j.a.post("/setprtowaitforapproval",n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){var n=new FormData;n.append("eventID",3),n.append("receiverID",e.RequestDetails.info[0].request_for),n.append("senderID",sessionStorage.getItem("EmpID")),n.append("Title",sessionStorage.getItem("name")),n.append("NotificationBody",sessionStorage.getItem("name")+" has sent your purchase request with id#"+t+" for approval"),j.a.post("/newnotification",n).then((function(){j.a.post("/sendmail",n).then((function(){}))})),e.ShowAllRequests();var a=null;a=C>15e4?JSON.stringify([514,515]):JSON.stringify([513,514]);var s=new FormData;s.append("access",a),j.a.post("/getemployeeaccesslike",s).then((function(e){if(e.data[0])for(var n=function(n){var a=new FormData;a.append("eventID",3),a.append("receiverID",e.data[n].emp_id),a.append("senderID",sessionStorage.getItem("EmpID")),a.append("Title",sessionStorage.getItem("name")),a.append("NotificationBody",sessionStorage.getItem("name")+" put forward a purchase request with id#"+t+" for approval"),j.a.post("/newnotification",a).then((function(){j.a.post("/sendmail",a).then((function(){}))}))},a=0;a<e.data.length;a++)n(a)})),I([]),M(Object(o.jsx)(o.Fragment,{})),V(!1),L(),B(!1),w(0),A(0)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}else{var a=m()(".InvoiceBuilder .errs").val(),s=0,i="Minimu 1 Specification is required!!!",c=50;a="",function e(){s<i.length&&(a+=i.charAt(s),m()(".InvoiceBuilder .errs").html(a),s++,setTimeout(e,c))}(),setTimeout((function(){m()(".InvoiceBuilder .errs").html("")}),5e3)}},G=function(t,n){n.preventDefault();var a=new FormData;a.append("prID",t),a.append("empID",e.EmpData.emp_id),a.append("remarks",n.target.remarks.value),j.a.post("/setprtodiscard",a).then((function(){var a=new FormData;a.append("eventID",3),a.append("receiverID",e.RequestDetails.info[0].request_for),a.append("senderID",sessionStorage.getItem("EmpID")),a.append("Title",sessionStorage.getItem("name")),a.append("NotificationBody",sessionStorage.getItem("name")+" has discard your purchase request with id#"+t+" under this reason '"+n.target.remarks.value+"'"),j.a.post("/newnotification",a).then((function(){j.a.post("/sendmail",a).then((function(){}))})),h.b.dark("Request has been Discard",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),I([]),M(Object(o.jsx)(o.Fragment,{})),V(!1),L(),B(!1),w(0),A(0),e.ShowAllRequests()})).catch((function(e){console.log(e)}))},W=function(e){var t=new FileReader,n=e.target.files;t.onload=function(){if(2===t.readyState){for(var e=[],a=document.querySelector(".invoAttachments"),s=0;s<n.length;s++)e.push({name:n[s].name,file:n[s]});x(e),Array.prototype.forEach.call(n,(function(t){if(t.type.indexOf(!1)){var n=document.createElement("div"),s=document.createElement("i");s.setAttribute("class","las la-times crossAttachments"),s.style.cursor="pointer",s.addEventListener("click",(function(){n.setAttribute("id",t.name),X(t.name,e)})),n.setAttribute("class","divs"),n.appendChild(s);var i=new Image;i.src=URL.createObjectURL(t),i.style.width="100%",i.style.height="-webkit-fill-available",n.appendChild(i),a.appendChild(n)}}))}},n[0]&&t.readAsDataURL(n[0])},X=function(e,t){var n=t.filter((function(t,n,a){return a[n].name!==e}));x(n),document.getElementById(e).style.display="none"},Z=function(){M(Object(o.jsxs)("div",{children:[Object(o.jsx)("h5",{children:"Attachments"}),Object(o.jsx)("input",{type:"file",onChange:W,name:"attachments",className:"d-none",id:"upload-photo",multiple:!0,accept:"image/*"}),Object(o.jsx)("div",{className:"invoAttachments",children:Object(o.jsx)("label",{for:"upload-photo",className:"m-0",children:Object(o.jsx)("div",{className:"divs",children:Object(o.jsx)("i",{className:"las la-plus"})})})})]})),V(!0)},$=function(){x([]),M(Object(o.jsx)(o.Fragment,{}))};return Object(r.useEffect)((function(){I(e.RequestDetails.specifications),w(null===e.RequestDetails.info[0].total?0:e.RequestDetails.info[0].total)}),[e.RequestDetails.info,e.RequestDetails.specifications]),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(d,{EmpData:e.EmpData,RequestDetails:e.RequestDetails,onOverride:function(e){},onApprove:function(e){},onSendingForApproval:function(e){for(var t=y,n=!0,a=0;a<t.length;a++)Object.values(y[a]).every((function(e){return""!==e&&0!==e}))||(alert("Please fill all the fields in the items list"),n=!1);n&&(M(Object(o.jsxs)("div",{children:[Object(o.jsx)("p",{children:"Do you want to send this request for approval?"}),Object(o.jsx)("button",{className:"btn btn-sm btn-success d-block ml-auto px-3",onClick:function(){return z(e)},children:"Yes"})]})),V(!0))},onDiscard:function(e){M(Object(o.jsxs)("div",{children:[Object(o.jsx)("p",{children:"Do you want to discard this request?"}),Object(o.jsxs)("form",{onSubmit:function(t){return G(e,t)},children:[Object(o.jsx)("textarea",{name:"remarks",className:"form-control mb-3",placeholder:"Add Remarks",required:!0,minLength:"10"}),Object(o.jsx)("button",{className:"btn btn-sm btn-danger d-block ml-auto px-3",children:"Yes"})]})]})),V(!0)},AttchemntsMode:function(e){var t=e.target.value;"yes"===t?(m()(".AttachmentsSelect").val(""),Z()):"view"===t?(m()(".AttachmentsSelect").val(""),V(!0)):$()},Items:y,onChnageHandler:function(e){var t=e.target,n=t.name,i=t.value,c=Object(s.a)(Object(s.a)({},l),{},Object(a.a)({},n,i));if(u(c),"price"===n){var r=i*l.quantity;A(r)}if("quantity"===n){var o=i*l.price;A(o)}},AddItem:function(e){if(Object.values(l).every((function(e){return""!==e&&0!==e}))&&13===e.keyCode)if(l.reason.length<20){var t=m()(".InvoiceBuilder .err_reason").val(),n=0,a="Reason must contain 20 characters minimum!!!",s=50;t="",function e(){n<a.length&&(t+=a.charAt(n),m()(".InvoiceBuilder .err_reason").html(t),n++,setTimeout(e,s))}(),setTimeout((function(){m()(".InvoiceBuilder .err_reason").html("")}),5e3)}else if(k){var c=y,r={};r=l.id?{id:l.id,pr_id:l.pr_id,description:l.description,reason:l.reason,price:l.price,quantity:l.quantity,amount:q}:{description:l.description,reason:l.reason,price:l.price,quantity:l.quantity,amount:q},w(C-c[H].amount+q),c[H]=r,I(c),A(0),u({description:"",reason:"",price:0,quantity:1}),B(!1),L(),m()(".InvoiceBuilder .edition").addClass("itemsEdit"),m()(".InvoiceBuilder .data").removeClass("d-none")}else{var o={description:l.description,reason:l.reason,price:l.price,quantity:l.quantity,amount:q};I([].concat(Object(i.a)(y),[o])),A(0),u({description:"",reason:"",price:0,quantity:1});var d=C;w(d+=q);var p=document.getElementById("ItemsLIst");null!==p&&(p.scrollTop=p.scrollHeight)}},Amount:q,Item:l,onDelete:function(e){I(y.filter((function(t,n){return n!==e}))),w(C-y[e].amount)},OnEdit:function(e){B(!0),L(e),A(y[e].amount),u({id:y[e].id,pr_id:y[e].pr_id,description:y[e].description,reason:y[e].reason,price:y[e].price,quantity:y[e].quantity}),m()(".InvoiceBuilder .edition").addClass("itemsEdit"),m()(".InvoiceBuilder .data").removeClass("d-none"),m()(".InvoiceBuilder .itemsEdit"+e).removeClass("itemsEdit"),m()(".InvoiceBuilder .itemsData"+e).addClass("d-none")},EditMode:k,Total:null===e.RequestDetails.info[0].total?0:e.RequestDetails.info[0].total}),Object(o.jsx)(p.a,{show:Y,Hide:function(){V(!Y)},content:J})]})}},94:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(18);var s=n(25);function i(e){return function(e){if(Array.isArray(e))return Object(a.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(s.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);
//# sourceMappingURL=53.f76c92a4.chunk.js.map