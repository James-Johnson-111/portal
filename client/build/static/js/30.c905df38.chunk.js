(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[30],{158:function(e,t,n){"use strict";t.a=n.p+"static/media/icons8-iphone-spinner.e2bb0653.gif"},660:function(e,t,n){},661:function(e,t,n){},784:function(e,t,n){"use strict";n.r(t);var a=n(11),c=n(4),s=n(1),i=n(77),r=n(80),o=n(10),l=n(158),d=(n(660),n(24)),u=n(98),j=n(3),b=(n(661),n(0)),p=function(e){var t=Object(s.useState)([]),n=Object(c.a)(t,2),a=n[0],i=n[1],r=Object(s.useState)([]),o=Object(c.a)(r,2),l=o[0],d=o[1];return Object(s.useEffect)((function(){i(e.Companies),d(e.Locations)}),[e.Locations,e.Companies]),Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:"SearchContainer",children:[Object(b.jsxs)("div",{className:"SearchBar",children:[Object(b.jsx)("div",{children:Object(b.jsx)("i",{class:"las la-search"})}),Object(b.jsx)("input",{type:"text",placeholder:"Tap To Search",className:"form-control",onChange:function(t){return e.onSearchPO("Key",t)}})]}),Object(b.jsxs)("div",{className:"SearchFiltersContainer",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Companies"}),Object(b.jsxs)("select",{name:"companies",id:"",onChange:e.onChangeCompany,className:"form-control",children:[Object(b.jsx)("option",{value:"",children:"Default"}),a.map((function(e){return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("option",{value:e.company_code,children:e.company_name})})}))]})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Locations"}),Object(b.jsxs)("select",{onChange:e.onChangeLocation,className:"form-control",children:[Object(b.jsx)("option",{value:"",children:"Default"}),l.map((function(e){return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("option",{value:e.location_code,children:e.location_name})})}))]})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Status"}),Object(b.jsxs)("select",{onChange:function(t){return e.onSearchPO("Status",t)},className:"form-control",children:[Object(b.jsx)("option",{value:"",children:"Default"}),Object(b.jsx)("option",{value:"Approved",children:"Approved"}),Object(b.jsx)("option",{value:"Rejected",children:"Rejected"}),Object(b.jsx)("option",{value:"Waiting For Approval",children:"Waiting For Approval"}),Object(b.jsx)("option",{value:"Sent",children:"Sent"}),Object(b.jsx)("option",{value:"Viewed",children:"Viewed"})]})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Date"}),Object(b.jsx)("input",{type:"date",onChange:function(t){return e.onSearchPO("MyDate",t)},className:"form-control",name:""})]})]})]})})},h=Object(s.lazy)((function(){return n.e(74).then(n.bind(null,804))})),O=Object(s.lazy)((function(){return Promise.all([n.e(3),n.e(5),n.e(47)]).then(n.bind(null,805))})),m=Object(s.lazy)((function(){return n.e(33).then(n.bind(null,821))})),f=Object(s.lazy)((function(){return n.e(72).then(n.bind(null,813))})),x=Object(s.lazy)((function(){return n.e(73).then(n.bind(null,806))})),v=Object(s.lazy)((function(){return n.e(71).then(n.bind(null,807))})),g=Object(s.lazy)((function(){return n.e(75).then(n.bind(null,808))}));t.default=function(){var e=Object(s.useState)(!1),t=Object(c.a)(e,2),n=t[0],w=t[1],S=Object(s.useState)(Object(b.jsx)(b.Fragment,{})),N=Object(c.a)(S,2),y=N[0],D=N[1],C=Object(s.useState)([]),_=Object(c.a)(C,2),k=_[0],P=(_[1],Object(s.useState)({column:"employees.name",value:""})),q=Object(c.a)(P,2),I=q[0],L=q[1],R=Object(s.useState)({column:"companies.company_code",value:""}),A=Object(c.a)(R,2),F=A[0],V=A[1],E=Object(s.useState)({column:"locations.location_code",value:""}),B=Object(c.a)(E,2),J=B[0],W=B[1],z=Object(s.useState)({column:"invtry_purchase_order.status",value:""}),T=Object(c.a)(z,2),H=T[0],M=T[1],Q=Object(s.useState)({column:"invtry_purchase_order.request_date",value:""}),K=Object(c.a)(Q,2),Y=K[0],G=K[1],U=Object(s.useState)([]),X=Object(c.a)(U,2),Z=X[0],$=X[1],ee=Object(s.useState)([]),te=Object(c.a)(ee,2),ne=te[0],ae=te[1],ce=Object(s.useState)([]),se=Object(c.a)(ce,2),ie=se[0],re=se[1],oe=Object(s.useState)([]),le=Object(c.a)(oe,2),de=le[0],ue=le[1],je=Object(s.useState)([]),be=Object(c.a)(je,2),pe=be[0],he=be[1],Oe=Object(s.useState)({info:[],specifications:[],venders:[]}),me=Object(c.a)(Oe,2),fe=me[0],xe=me[1],ve=Object(s.useState)({info:[],specifications:[]}),ge=Object(c.a)(ve,2),we=ge[0],Se=ge[1],Ne=Object(s.useState)(0),ye=Object(c.a)(Ne,2),De=ye[0],Ce=ye[1],_e=Object(s.useState)([]),ke=Object(c.a)(_e,2),Pe=ke[0],qe=ke[1],Ie=Object(s.useState)([]),Le=Object(c.a)(Ie,2),Re=Le[0],Ae=Le[1],Fe=Object(s.useState)([]),Ve=Object(c.a)(Fe,2),Ee=Ve[0],Be=Ve[1],Je=Object(s.useState)([]),We=Object(c.a)(Je,2),ze=We[0],Te=We[1],He=Object(s.useState)([]),Me=Object(c.a)(He,2),Qe=Me[0],Ke=Me[1],Ye=Object(s.useState)([]),Ge=Object(c.a)(Ye,2),Ue=Ge[0],Xe=Ge[1],Ze=Object(s.useState)(),$e=Object(c.a)(Ze,2),et=$e[0],tt=$e[1],nt=Object(d.c)((function(e){return e.EmpAuth.EmployeeData})),at=Object(j.g)();Object(s.useMemo)((function(){return tt(window.location.href.split("/").pop().split("id=").pop())}),[parseInt(window.location.href.split("/").pop().split("id=").pop())]),Object(s.useEffect)((function(){if(!isNaN(parseInt(et))){var e=window.location.href.split("/").pop().split("id=").pop();o.a.post("/getpridfrompo",{po_id:e}).then((function(t){o.a.post("/getpurchaseorderdetails",{pr_id:t.data[0]?t.data[0].pr_id:null,po_id:e}).then((function(t){Ae([]),Te([]),Xe([]);var n=t.data[0];t.data[4][0]&&(n[0].pr_code=t.data[4][0].pr_code),he(t.data[0]),xe(Object(a.a)(Object(a.a)({},fe),{},{info:n,specifications:t.data[1],venders:t.data[3]})),Be(t.data[2]),Ke(t.data[7]),t.data[4][0]?(Se(Object(a.a)(Object(a.a)({},we),{},{info:t.data[4],specifications:t.data[5]})),qe(t.data[6])):(Se(Object(a.a)(Object(a.a)({},we),{},{info:[],specifications:[]})),qe([])),Ce(parseInt(e))})).catch((function(e){console.log(e)}))}))}}),[et]),Object(s.useEffect)((function(){st()}),[I,F,J,H,Y]),Object(s.useEffect)((function(){u.a.on("newpurchaseorder",(function(){ct()})),ct(),ut(),dt()}),[]);var ct=function(){var e={emp_id:nt.emp_id,access:nt.access};o.a.post("/getallpo",{myData:JSON.stringify(e)}).then((function(e){re(e.data)})).catch((function(e){console.log(e)}))},st=function(){var e={emp_id:nt.emp_id,access:nt.access},t=[I,F,J,H,Y];o.a.post("/getallposorted",{myData:JSON.stringify(e),filters:t}).then((function(e){re(e.data);for(var t=[],n=0;n<e.data.length;n++)t.push(e.data[n].status);ue(t)})).catch((function(e){console.log(e)}))},it=function(){w(!n)},rt=function(e,t){var n=t.target.value;"Key"===e?L(Object(a.a)(Object(a.a)({},I),{},{value:n})):"Company"===e?V(Object(a.a)(Object(a.a)({},F),{},{value:n})):"Location"===e?W(Object(a.a)(Object(a.a)({},J),{},{value:n})):"Status"===e?M(Object(a.a)(Object(a.a)({},H),{},{value:n})):G(Object(a.a)(Object(a.a)({},Y),{},{value:n})),"Key"===e&&""===n?L(Object(a.a)(Object(a.a)({},I),{},{value:""})):"Company"===e&&""===n?V(Object(a.a)(Object(a.a)({},F),{},{value:""})):"Location"===e&&""===n?W(Object(a.a)(Object(a.a)({},J),{},{value:""})):"Status"===e&&""===n?M(Object(a.a)(Object(a.a)({},H),{},{value:""})):"MyDate"===e&&""===n&&G(Object(a.a)(Object(a.a)({},Y),{},{value:""}))},ot=function(e){rt("Company",e),""!==e.target.value?o.a.post("/getcompanylocations",{company_code:e.target.value}).then((function(e){ae(e.data)})).catch((function(e){console.log(e)})):dt()},lt=function(e){rt("Location",e),dt()},dt=function(){o.a.get("/getalllocations").then((function(e){ae(e.data)})).catch((function(e){console.log(e)}))},ut=function(){o.a.get("/getallcompanies").then((function(e){$(e.data)})).catch((function(e){console.log(e)}))},jt=function(e,t){if("Sent"===t&&(JSON.parse(nt.access).includes(523)||JSON.parse(nt.access).includes(524)||JSON.parse(nt.access).includes(1))){var n=new FormData;n.append("poID",e),n.append("empID",nt.emp_id),o.a.post("/setpotoviewed",n).then((function(){u.a.emit("newpurchaseorder")})).catch((function(e){console.log(e)}))}},bt=function(e){var t=[];t=Pe[0].image?Pe.filter((function(t,n,a){return a[n].image===a[e].image})):Pe.filter((function(t,n,a){return a[n].name===a[e].name})),Ae(t)},pt=function(e){var t=[];t=Ee[0].image?Ee.filter((function(t,n,a){return a[n].image===a[e].image})):Ee.filter((function(t,n,a){return a[n].name===a[e].name})),Te(t)},ht=function(e){var t=[];t=Qe[0].image?Qe.filter((function(t,n,a){return a[n].image===a[e].image})):Qe.filter((function(t,n,a){return a[n].name===a[e].name})),Xe(t)},Ot=function(e){var t=new FileReader,n=e.target.files;t.onload=function(){if(2===t.readyState){for(var e=[],a=0;a<n.length;a++)e.push({name:n[a].name,file:n[a]});Ke(e)}},n[0]&&t.readAsDataURL(n[0])},mt=function(e){var t=Qe.filter((function(t,n,a){return a[n].name!==a[e].name}));Ke(t),Xe([])},ft=function(e,t){t.preventDefault();var n=new FormData;n.append("poID",e),n.append("empID",nt.emp_id),n.append("remarks",t.target.remarks.value),o.a.post("/setpotodiscard",n).then((function(){var n=new FormData;n.append("eventID",3),n.append("link",""),n.append("receiverID",pe[0].request_by),n.append("senderID",sessionStorage.getItem("EmpID")),n.append("Title",sessionStorage.getItem("name")),n.append("NotificationBody",sessionStorage.getItem("name")+" has discard your purchase order with id#"+pe[0].po_code+" under this reason '"+t.target.remarks.value+"'"),o.a.post("/newnotification",n).then((function(){o.a.post("/sendmail",n).then((function(){u.a.emit("newpurchaseorder"),at.replace("/purchaseorder/window=purchaseorder&&id="+(e-1)),setTimeout((function(){at.replace("/purchaseorder/window=purchaseorder&&id="+e)}),100),st()}))})),i.b.dark("Request has been Discard",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),w(!1)})).catch((function(e){console.log(e)}))},xt=function(e,t){t.preventDefault();var n=new FormData;n.append("poID",e),n.append("empID",nt.emp_id),n.append("remarks",t.target.remarks.value),Qe.forEach((function(e){n.append("Attachments",e.file)})),o.a.post("/setpotoapprove",n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){w(!1);var t=new FormData;t.append("eventID",3),t.append("receiverID",pe[0].request_by),t.append("senderID",sessionStorage.getItem("EmpID")),t.append("Title",sessionStorage.getItem("name")),t.append("NotificationBody",sessionStorage.getItem("name")+" has approved your purchase order with id#"+pe[0].po_code),o.a.post("/newnotification",t).then((function(){o.a.post("/sendmail",t).then((function(){u.a.emit("newpurchaseorder"),at.replace("/purchaseorder/window=purchaseorder&&id="+(e-1)),setTimeout((function(){at.replace("/purchaseorder/window=purchaseorder&&id="+e)}),100),st()}))})),i.b.dark("Request has been approved".toString(),{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){console.log(e)}))};return Object(b.jsxs)("div",{className:"ViewPurchaseOrderContainer",children:[Object(b.jsx)(i.a,{}),Object(b.jsx)(r.a,{show:n,Hide:it,content:y}),Object(b.jsx)("iframe",{title:"po",id:"po",className:"d-none w-100",src:"https://"+window.location.host+"/#/view=purchase_order/"+De}),Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Processing...."})]})}),children:Object(s.useMemo)((function(){return Object(b.jsx)(p,{Locations:ne,Companies:Z,onChangeLocation:lt,onChangeCompany:ot,onSearchPO:rt})}),[ne,Z])}),Object(b.jsxs)("div",{className:"ViewPurchaseOrderGridContainer",children:[Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{className:"text-center",children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Loading Requests"})]})}),children:Object(b.jsx)("div",{className:"Left RequestsList",children:ie.map((function(e,t){var n=new Date(e.request_date);return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(h,{data:e,date:n,EmpData:nt,ViewRequestDetails:jt},t)})}))})}),Object(b.jsxs)("div",{className:"Right RequestDetails",children:[Object(b.jsxs)("div",{className:"PreviewWindow",children:[Object(b.jsx)(j.b,{exact:!0,path:"/purchaseorder/home",render:function(){return Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Please Wait"})]})}),children:Object(b.jsx)(O,{ViewRequest:ie,CountRequests:ie.length,CountStatus:de,MonthlyRequests:k,EmpData:nt})})}}),Object(b.jsx)(j.b,{exact:!0,path:"/purchaseorder/window=purchaseorder&&id=:id",render:function(){return Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Please Wait"})]})}),children:Object(b.jsx)(m,{PurchaseOrderDetails:fe})})}}),Object(b.jsx)(j.b,{exact:!0,path:"/purchaseorder/window=purchaserequisition&&id=:id",render:function(){return Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Please Wait"})]})}),children:Object(b.jsx)(f,{PurchaseRequisitionDetails:we})})}}),Object(b.jsx)(j.b,{exact:!0,path:"/purchaseorder/window=quotations&&id=:id",render:function(){return Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Please Wait"})]})}),children:Object(b.jsx)(x,{List:pe,AttachQuotations:Pe,QuotationPreview:Re,PreviewQuotation:bt})})}}),Object(b.jsx)(j.b,{exact:!0,path:"/purchaseorder/window=bills&&id=:id",render:function(){return Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Please Wait"})]})}),children:Object(b.jsx)(v,{AttachBills:Ee,BillPreview:ze,PreviewBill:pt})})}}),Object(b.jsx)(j.b,{exact:!0,path:"/purchaseorder/window=vouchers&&id=:id",render:function(){return Object(b.jsx)(s.Suspense,{fallback:Object(b.jsx)("div",{className:"w-100 d-flex justify-content-center mt-5",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{className:"rounded-circle",src:l.a,width:"60",height:"60",alt:"Loading...."}),Object(b.jsx)("p",{className:"mb-0",children:"Please Wait"})]})}),children:Object(b.jsx)(g,{Details:pe,AttachVouchers:Qe,VoucherPreview:Ue,PreviewVoucher:ht,onAttachVouchers:Ot,RemoveVoucher:mt})})}})]}),Object(b.jsx)("div",{className:"POControls",children:"home"!==window.location.href.split("/").pop()?Object(b.jsxs)("div",{className:"btn-group",children:[Object(b.jsx)("button",{className:"btn btn-dark",onClick:function(){return at.replace("/purchaseorder/window=purchaseorder&&id="+De)},children:"Purchase Order"}),we.info[0]?Object(b.jsx)("button",{className:"btn btn-primary",onClick:function(){return at.replace("/purchaseorder/window=purchaserequisition&&id="+De)},children:"Purchase Requisition"}):null,Pe.length>0?Object(b.jsx)("button",{className:"btn btn-info",onClick:function(){return at.replace("/purchaseorder/window=quotations&&id="+De)},children:"Quotations"}):null,Object(b.jsx)("button",{className:"btn btn-light",onClick:function(){return at.replace("/purchaseorder/window=bills&&id="+De)},children:"Bills"}),Object(b.jsx)("button",{className:"btn btn-danger",onClick:function(){return at.replace("/purchaseorder/window=vouchers&&id="+De)},children:"Vouchers"}),Object(b.jsx)("button",{className:"btn btn-warning",onClick:function(){return function(e){var t=we.info[0]?we.info[0].pr_id:0,n=document.getElementById("po");n.src="https://"+window.location.host+"/#/view=purchase_order/"+t+"/"+e,n.contentWindow.print()}(De)},children:"Print"}),pe[0]&&("Viewed"===pe[0].status||"Sent"===pe[0].status)&&nt.access&&(JSON.parse(nt.access).includes(523)||JSON.parse(nt.access).includes(524)||JSON.parse(nt.access).includes(1))?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{className:"btn btn-sm btn-danger",onClick:function(){return e=window.location.href.split("/").pop().split("id=").pop(),D(Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:"Do you want to discard this request?"}),Object(b.jsxs)("form",{onSubmit:function(t){return ft(e,t)},children:[Object(b.jsx)("textarea",{style:{fontSize:"13px"},name:"remarks",className:"form-control mb-3",placeholder:"Add Remarks",required:!0,minLength:"10"}),Object(b.jsx)("button",{type:"submit",className:"btn btn-sm btn-danger d-block ml-auto px-3",children:"Yes"})]})]})),void it();var e},children:"Discard"}),Object(b.jsx)("button",{className:"btn btn-sm btn-success",onClick:function(){return e=window.location.href.split("/").pop().split("id=").pop(),void(0===Qe.length?i.b.dark("Please attach at least one voucher",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):(D(Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:"Do you want to approve this request?"}),Object(b.jsxs)("form",{onSubmit:function(t){return xt(e,t)},children:[Object(b.jsx)("textarea",{style:{fontSize:"13px"},name:"remarks",className:"form-control mb-3",placeholder:"Add Remarks",required:!0,minLength:"10"}),Object(b.jsx)("button",{type:"submit",className:"btn btn-sm btn-success d-block ml-auto px-3",children:"Yes"})]})]})),it()));var e},children:"Approve"})]}):null]}):null})]})]})]})}},80:function(e,t,n){"use strict";n(1),n(85);var a=n(0);t.a=function(e){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"Attandence_Request_Div",style:{display:e.show?"flex":"none"},children:[Object(a.jsx)("div",{className:"dark",onClick:e.Hide}),Object(a.jsx)("div",{style:{animationDelay:"0.1".toString()+"s"},className:e.show?"Attandence_Request_Div_Content Attandence_Request_Div_Content2":"Attandence_Request_Div_Content",children:e.content})]})})}},85:function(e,t,n){}}]);
//# sourceMappingURL=30.c905df38.chunk.js.map